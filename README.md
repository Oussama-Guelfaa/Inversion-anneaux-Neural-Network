# üî¨ Inversion d'Anneaux - Neural Network Project

**Auteur:** Oussama GUELFAA
**Date:** 19 - 06 - 2025

## üìñ Vue d'Ensemble du Projet

Ce projet impl√©mente des **solutions de r√©seaux de neurones sp√©cialis√©es** pour l'analyse holographique d'anneaux et la pr√©diction de param√®tres physiques. Le projet contient plusieurs impl√©mentations optimis√©es pour diff√©rents cas d'usage, de la recherche √† la production.

### üéØ Objectifs Principaux

- **Pr√©diction de param√®tres holographiques** : gap et L_√©cran √† partir de profils d'intensit√©
- **Architectures sp√©cialis√©es** : R√©seaux optimis√©s pour chaque type de pr√©diction
- **Performance √©lev√©e** : R¬≤ > 0.95 pour tous les mod√®les de production
- **Robustesse valid√©e** : Tests de bruit, overfitting, g√©n√©ralisation

## üèóÔ∏è Architecture du Projet

```
Inversion_anneaux/
‚îú‚îÄ‚îÄ üéØ R√©seaux de Neurones Principaux
‚îÇ   ‚îú‚îÄ‚îÄ Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25/  # ‚≠ê ULTRA-PR√âCISION - Dual prediction
‚îÇ   ‚îú‚îÄ‚îÄ Reseau_Neural_Dual_Gap_Lecran_FINAL_06_01_25/           # Production - Dual prediction
‚îÇ   ‚îî‚îÄ‚îÄ Reseaux_1D_Gap_Prediction/                              # Pr√©diction gap seul
‚îÇ       ‚îú‚îÄ‚îÄ Reseau_Noise_Robustness/                   # Tests robustesse bruit
‚îÇ       ‚îú‚îÄ‚îÄ Reseau_Gap_Prediction_CNN/                 # CNN sp√©cialis√© gap
‚îÇ       ‚îî‚îÄ‚îÄ Reseau_Overfitting_Test/                   # Validation overfitting
‚îú‚îÄ‚îÄ üìä Donn√©es et Scripts
‚îÇ   ‚îú‚îÄ‚îÄ data_generation/                               # Donn√©es MATLAB originales
‚îÇ   ‚îú‚îÄ‚îÄ analysis_scripts/                              # Scripts d'analyse
‚îÇ   ‚îî‚îÄ‚îÄ utilities/                                     # Utilitaires communs
‚îú‚îÄ‚îÄ üì¶ Archives
‚îÇ   ‚îú‚îÄ‚îÄ archive_legacy_networks/                       # Anciens r√©seaux
‚îÇ   ‚îú‚îÄ‚îÄ legacy_images/                                 # Images historiques
‚îÇ   ‚îî‚îÄ‚îÄ legacy_tests/                                  # Tests historiques
‚îî‚îÄ‚îÄ üìã README.md                                       # Cette documentation
```

## üìÅ Structure Modulaire Standardis√©e

Chaque r√©seau de neurones suit la m√™me organisation :

```
Reseau_XYZ/
‚îú‚îÄ‚îÄ run.py              # Script autonome principal
‚îú‚îÄ‚îÄ demo.py             # D√©monstration rapide (si disponible)
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml     # Configuration compl√®te
‚îú‚îÄ‚îÄ models/             # Mod√®les entra√Æn√©s (.pth, .h5, .pkl)
‚îú‚îÄ‚îÄ plots/              # Visualisations automatiques
‚îú‚îÄ‚îÄ results/            # M√©triques et rapports (JSON, CSV)
‚îú‚îÄ‚îÄ docs/               # Documentation sp√©cialis√©e
‚îú‚îÄ‚îÄ data/               # Donn√©es pr√©trait√©es
‚îú‚îÄ‚îÄ logs/               # Logs d'entra√Ænement
‚îî‚îÄ‚îÄ src/                # Code source modulaire
```

## üöÄ Guide d'Ex√©cution Rapide

### 1Ô∏è‚É£ Installation des D√©pendances

```bash
# D√©pendances communes
pip install torch pandas numpy matplotlib seaborn scikit-learn pyyaml scipy joblib

# Pour TensorFlow (optionnel)
pip install tensorflow
```

### 2Ô∏è‚É£ Choix du R√©seau selon l'Usage

#### üèÜ Pour Production (Recommand√©)
```bash
# R√©seau ultra-pr√©cision (NOUVEAU - 19/06/2025)
cd Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25
cd src/
python run.py

# Ou d√©monstration rapide
python demo.py

# Tests avanc√©s
cd ../Test_dataset/
python test_dataset_2D.py  # Test sur 2440 √©chantillons
```

#### üéØ Alternative Production
```bash
# R√©seau production stable
cd Reseau_Neural_Dual_Gap_Lecran_FINAL_06_01_25
python run.py
```

#### üî¨ Pour Recherche Gap Seul
```bash
# Robustesse au bruit (le plus robuste)
cd Reseaux_1D_Gap_Prediction/Reseau_Noise_Robustness
python run.py

# CNN sp√©cialis√© gap
cd Reseaux_1D_Gap_Prediction/Reseau_Gap_Prediction_CNN
python run.py
```

#### üß™ Pour Tests et Validation
```bash
# Test d'overfitting
cd Reseaux_1D_Gap_Prediction/Reseau_Overfitting_Test
python run.py
```

### 3Ô∏è‚É£ Analyse des R√©sultats

```bash
# Scripts d'analyse des donn√©es
cd analysis_scripts
python analyze_existing_results.py
python test_model_on_real_data.py

# Analyse compl√®te dataset 2D
cd analysis_scripts/dataset_2D_analysis
python run_complete_dataset_2D_analysis.py
```

## üéØ Localisation des Mod√®les Entra√Æn√©s

### Mod√®les de Production

#### R√©seau Ultra-Pr√©cision (‚≠ê NOUVEAU - RECOMMAND√â)
- **Localisation** : `Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25/models/`
- **Mod√®les** :
  - `dual_parameter_model.pth` - Mod√®le PyTorch ultra-pr√©cis (1,318,882 param√®tres)
  - `input_scaler.pkl` - Normalisateur des profils d'intensit√©
  - `gap_scaler.pkl` - Normalisateur sp√©cialis√© gap
  - `L_ecran_scaler.pkl` - Normalisateur sp√©cialis√© L_√©cran
- **Performance** : R¬≤ = 0.9948 (gap), R¬≤ = 0.9891 (L_√©cran)
- **Pr√©cision** : 99.4% gap (¬±0.01¬µm), 94.2% L_√©cran (¬±0.1¬µm)
- **Valid√© sur** : 2440 √©chantillons (dataset_2D)
- **Usage** : Production industrielle haute pr√©cision

#### R√©seau Production Stable
- **Localisation** : `Reseau_Neural_Dual_Gap_Lecran_FINAL_06_01_25/models/`
- **Mod√®les** :
  - `dual_gap_lecran_model.pth` - Mod√®le PyTorch principal
  - `scaler_X.pkl` - Normalisateur des donn√©es d'entr√©e
  - `scaler_y.pkl` - Normalisateur des param√®tres de sortie
- **Performance** : R¬≤ = 0.9948 (gap), R¬≤ = 0.9949 (L_√©cran)
- **Usage** : Pr√©diction conjointe gap + L_√©cran

#### R√©seaux Gap Seul
- **Noise Robustness** : `Reseaux_1D_Gap_Prediction/Reseau_Noise_Robustness/models/`
  - `noise_robust_model_5pct.pth` - Mod√®le robuste au bruit
  - Performance : R¬≤ = 0.9948, robuste jusqu'√† 10% de bruit
- **CNN Gap** : `Reseaux_1D_Gap_Prediction/Reseau_Gap_Prediction_CNN/models/`
  - `gap_prediction_cnn.pth` - CNN sp√©cialis√© gap
  - Performance : R¬≤ > 0.99

### Mod√®les de Test et Validation
- **Overfitting Test** : `Reseaux_1D_Gap_Prediction/Reseau_Overfitting_Test/models/`
- **Archives** : `archive_legacy_networks/` (mod√®les historiques)

## üß≠ Navigation entre Impl√©mentations

### Par Type de Pr√©diction

#### Pr√©diction Dual (Gap + L_√©cran)
```bash
# R√©seau ultra-pr√©cision (NOUVEAU - RECOMMAND√â)
cd Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25
cd src/
```
- **Architecture** : 1,318,882 param√®tres optimis√©s
- **Donn√©es** : 600 points par profil (tronqu√© optimis√©)
- **Innovation** : Data augmentation avanc√©e + scaling s√©par√©
- **R√©sultats** : R¬≤ = 0.9948 (gap), R¬≤ = 0.9891 (L_√©cran)
- **Pr√©cision** : 99.4% gap, 94.2% L_√©cran dans tol√©rances industrielles
- **Valid√©** : 2440 √©chantillons dataset_2D

```bash
# R√©seau production stable (Alternative)
cd Reseau_Neural_Dual_Gap_Lecran_FINAL_06_01_25
```
- **Architecture** : Dense layers 512‚Üí256‚Üí128‚Üí64‚Üí2
- **Donn√©es** : 600 points par profil (optimis√©)
- **Innovation** : Data augmentation 2D par interpolation
- **R√©sultats** : R¬≤ > 0.99 pour les deux param√®tres

#### Pr√©diction Gap Seul
```bash
# Pour robustesse maximale
cd Reseaux_1D_Gap_Prediction/Reseau_Noise_Robustness

# Pour performance pure
cd Reseaux_1D_Gap_Prediction/Reseau_Gap_Prediction_CNN

# Pour validation
cd Reseaux_1D_Gap_Prediction/Reseau_Overfitting_Test
```

### Par Framework

#### PyTorch (Principal)
- Tous les r√©seaux utilisent PyTorch par d√©faut
- Architecture modulaire avec blocs r√©siduels
- Optimisation Adam + ReduceLROnPlateau

#### TensorFlow (Alternatif)
- Impl√©mentations alternatives disponibles dans certains r√©seaux
- Architecture Dense Sequential
- Compatible avec les mod√®les PyTorch

## üìä Donn√©es et Formats

### Source des Donn√©es
- **Fichier principal** : `data_generation/all_banque_new_24_01_25_NEW_full.mat`
- **Variables** : L_ecran_subs_vect, gap_subs_vect, I_subs, I_subs_inc
- **√âchantillons** : 990 profils d'intensit√© originaux
- **Augmentation** : Jusqu'√† 12,200 √©chantillons (facteur 5x)

### Formats de Sortie
- **Mod√®les** : `.pth` (PyTorch), `.pkl` (Scalers)
- **R√©sultats** : `.json` (m√©triques), `.csv` (historiques)
- **Visualisations** : `.png` (plots haute r√©solution)

## üèÜ Performances et R√©sultats

### R√©seau Ultra-Pr√©cision (NOUVEAU - 19/06/2025)
- **Gap** : R¬≤ = 0.9948, MAE = 0.0035 ¬µm, RMSE = 0.0042 ¬µm
- **L_√©cran** : R¬≤ = 0.9891, MAE = 0.0335 ¬µm, RMSE = 0.0460 ¬µm
- **Pr√©cision industrielle** : 99.4% gap (¬±0.01¬µm), 94.2% L_√©cran (¬±0.1¬µm)
- **Validation** : 2440 √©chantillons dataset_2D
- **Architecture** : 1,318,882 param√®tres optimis√©s
- **Temps d'entra√Ænement** : 300 epochs

### R√©seau Dual (Production Stable)
- **Gap** : R¬≤ = 0.9946, RMSE = 0.062 ¬µm
- **L_√©cran** : R¬≤ = 0.9949, RMSE = 0.125 ¬µm
- **Pr√©cision** : 97% (gap), 99.9% (L_√©cran)
- **Temps d'entra√Ænement** : 4.2 minutes

### R√©seaux Gap Seul
- **Noise Robustness** : R¬≤ = 0.9948, robuste jusqu'√† 10% bruit
- **CNN Gap** : R¬≤ > 0.99, convergence rapide
- **Overfitting Test** : Validation compl√®te, pas de surapprentissage

## üîß Utilitaires et Outils

### Scripts d'Analyse
- **`analysis_scripts/`** : Analyse compl√®te des donn√©es et r√©sultats
- **Dataset 2D Analysis** : Suite de 8 scripts sp√©cialis√©s
- **Test sur donn√©es r√©elles** : Validation sur donn√©es exp√©rimentales

### Utilitaires Communs
- **`utilities/`** : Fonctions partag√©es, configurations, exemples
- **Data augmentation** : Scripts d'augmentation 2D par interpolation
- **Validation** : Outils de test et m√©triques standardis√©es

## üìà Recommandations d'Usage

### Pour Utilisateurs Finaux
1. **Utiliser** : `Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25` (NOUVEAU)
2. **Ex√©cuter** : `cd src/ && python run.py` ou `python demo.py`
3. **Tests** : `cd Test_dataset/ && python test_dataset_2D.py`
4. **R√©sultats** : Consultez `results/` et `plots/`
5. **Alternative** : `Reseau_Neural_Dual_Gap_Lecran_FINAL_06_01_25` (stable)

### Pour D√©veloppeurs
1. **√âtudier** : Structure modulaire dans `src/`
2. **Configurer** : Modifier `config/config.yaml`
3. **√âtendre** : Utiliser `utilities/` comme base

### Pour Chercheurs
1. **Analyser** : Scripts dans `analysis_scripts/`
2. **Comparer** : Diff√©rents r√©seaux dans `Reseaux_1D_Gap_Prediction/`
3. **Valider** : Tests de robustesse et overfitting

## üÜï NOUVEAU - R√©seau Ultra-Pr√©cision (19/06/2025)

### üéØ R√©seau Neural Dual Gap + L_ecran - PRECISION 007¬µm

**Localisation** : `Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25/`

#### ‚ú® Innovations Cl√©s
- **Architecture optimis√©e** : 1,318,882 param√®tres finement ajust√©s
- **Scaling s√©par√©** : Normalisation ind√©pendante gap/L_√©cran
- **Data augmentation avanc√©e** : Interpolation sophistiqu√©e
- **Structure organis√©e** : Code source dans `src/`, tests dans `Test_dataset/`, docs dans `docs/`

#### üèÜ Performances Exceptionnelles
- **Gap** : R¬≤ = 0.9948 (99.48%), MAE = 0.0035¬µm
- **L_√©cran** : R¬≤ = 0.9891 (98.91%), MAE = 0.0335¬µm
- **Pr√©cision industrielle** : 99.4% gap (¬±0.01¬µm), 94.2% L_√©cran (¬±0.1¬µm)
- **Validation √©tendue** : 2440 √©chantillons dataset_2D

#### üöÄ Utilisation Rapide
```bash
cd Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25

# D√©monstration
cd src/
python demo.py

# Test complet sur dataset_2D
cd ../Test_dataset/
python test_dataset_2D.py

# Test sur nouvelles donn√©es
python test_nouvelles_donnees.py
```

#### üìÅ Structure Organis√©e
```
Reseau_Neural_Dual_Gap_Lecran_PRECISION_007um_14_01_25/
‚îú‚îÄ‚îÄ src/                    # Code source principal
‚îú‚îÄ‚îÄ Test_dataset/           # Scripts de test et validation
‚îú‚îÄ‚îÄ docs/                   # Documentation compl√®te
‚îú‚îÄ‚îÄ models/                 # Mod√®les entra√Æn√©s
‚îú‚îÄ‚îÄ results/                # R√©sultats des tests
‚îî‚îÄ‚îÄ plots/                  # Visualisations
```

---

**üéØ R√©sultat : Ma√Ætrise compl√®te de la pr√©diction de param√®tres holographiques avec pr√©cision industrielle ultra-haute !**